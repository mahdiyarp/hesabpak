{% extends 'base.html' %}
{% block content %}
<h2>ویرایش {{ 'شخص' if ent.type=='person' else 'کالا' }}</h2>

<form method="post" action="{{ prefix }}/entities/{{ ent.id }}/edit" class="login-form" style="max-width:640px">
  <div style="margin:8px 0">
    <div class="lbl" style="font-weight:600">نوع</div>
    <div class="type-toggle">
      <label class="pill"><input type="radio" name="type" value="person" {% if ent.type=='person' %}checked{% endif %}> شخص</label>
      <label class="pill"><input type="radio" name="type" value="item" {% if ent.type=='item' %}checked{% endif %}> کالا</label>
    </div>
  </div>

  <div style="margin:8px 0">
    <label class="lbl">کد</label>
    <input class="inp" name="code" value="{{ ent.code }}" required>
  </div>

  <div style="margin:8px 0">
    <label class="lbl">نام</label>
    <input class="inp" name="name" value="{{ ent.name }}" required>
  </div>

  <div style="margin:8px 0">
    <label class="lbl">{{ 'نوع شخص' if ent.type=='person' else 'واحد' }}</label>
    <input class="inp" name="unit" value="{{ ent.unit or '' }}">
  </div>

  <div style="margin:8px 0">
    <label class="lbl">سریال</label>
    <input class="inp" name="serial_no" value="{{ ent.serial_no or '' }}">
  </div>

  <div style="margin:8px 0">
    <label class="lbl">والد</label>
    <select class="inp" name="parent_id">
      <option value="">— بدون والد —</option>
      <optgroup label="والد سطح ۱">
        {% for p in parents_lvl1 %}
          <option value="{{ p.id }}" {% if ent.parent_id==p.id %}selected{% endif %}>[{{ p.code }}] {{ p.name }}</option>
        {% endfor %}
      </optgroup>
      <optgroup label="والد سطح ۲">
        {% for p in parents_lvl2 %}
          <option value="{{ p.id }}" {% if ent.parent_id==p.id %}selected{% endif %}>[{{ p.code }}] {{ p.name }}</option>
        {% endfor %}
      </optgroup>
    </select>
  </div>

  <button class="btn-primary" type="submit">ذخیره</button>
  <a href="{{ prefix }}/entities?kind={{ ent.type }}" class="card" style="display:inline-block;margin-top:14px">بازگشت</a>
</form>
{% endblock %}
